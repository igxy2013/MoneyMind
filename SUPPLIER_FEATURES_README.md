# 供应商管理新功能说明

## 新增功能

### 1. 供应商类型标签
为每个供应商添加了类型分类，包括：
- 产地直供/合作社
- 本地批发市场供应商
- 一件代发供应商
- 社区本地农户/小农场
- 核心供应商
- 备用供应商
- 临时供应商

### 2. 图片上传功能
- 支持上传供应商场地照片
- 支持格式：JPG、PNG、GIF、WEBP
- 最大文件大小：16MB
- 图片存储在 `static/uploads/suppliers/` 目录

### 3. 供货品类字段
- 记录供应商主要供应的货品品类
- 支持多个品类，用逗号分隔
- 便于了解供应商的专业领域

### 4. 供应商详情页面
- 新增供应商详情查看页面
- 显示完整的供应商信息
- 展示供应商场地照片
- 显示该供应商供应的商品列表

## 数据库变更

### 新增字段
- `supplier_type` (VARCHAR(50)): 供应商类型
- `supply_categories` (TEXT): 供货品类
- `image_path` (VARCHAR(255)): 图片文件路径

## 部署步骤

### 1. 运行数据库迁移
```bash
python migrate_supplier_fields.py
```

### 2. 测试新功能
```bash
python test_supplier_features.py
```

### 3. 启动应用
```bash
python app.py
```

## 使用说明

### 添加供应商
1. 进入供应商管理页面
2. 点击"添加供应商"按钮
3. 填写基本信息
4. 选择供应商类型
5. 填写供货品类
6. 上传场地照片（可选）
7. 保存供应商信息

### 编辑供应商
1. 在供应商列表中点击编辑按钮
2. 修改相关信息
3. 可以更换场地照片
4. 保存修改

### 查看供应商详情
1. 在供应商列表中点击查看详情按钮
2. 查看完整的供应商信息
3. 查看场地照片
4. 查看供应的商品列表

## 文件结构

```
static/
├── uploads/
│   └── suppliers/          # 供应商图片存储目录
templates/
├── suppliers.html          # 供应商列表页面（已更新）
├── add_supplier.html       # 添加供应商页面（已更新）
├── edit_supplier.html      # 编辑供应商页面（已更新）
└── supplier_detail.html    # 供应商详情页面（新增）
```

## 注意事项

1. 确保 `static/uploads/suppliers/` 目录存在且有写入权限
2. 图片文件会自动生成唯一文件名，避免冲突
3. 删除供应商时会自动删除相关的图片文件
4. 更新图片时会删除旧图片文件

## 技术实现

- 使用 Flask 的文件上传功能
- 使用 UUID 生成唯一文件名
- 支持多种图片格式
- 自动创建上传目录
- 文件大小限制和格式验证
