{% extends "base.html" %}

{% block title %}添加应收款 - 七彩果坊经营管理系统{% endblock %}

{% block extra_head %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
<style>
:where([class^="ri-"])::before { content: "\f3c2"; }
</style>
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
<div class="mb-8">
<div class="flex items-center justify-between mb-8">
<div>
<div class="flex items-center space-x-3 mb-2">
<a href="{{ url_for('receivables') }}" class="w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-colors">
<div class="w-4 h-4 flex items-center justify-center">
<i class="ri-arrow-left-line text-gray-600"></i>
</div>
</a>
<h1 class="text-3xl font-bold text-gray-900 mb-2">添加应收款</h1>
</div>
<p class="text-gray-600">录入新的应收款记录，完善客户账款管理</p>
</div>
</div>

<div class="bg-white/60 backdrop-blur-lg rounded-2xl shadow-lg border border-white/20 p-8">
<form method="POST" id="receivableForm" class="space-y-8">
<div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6">
<h3 class="text-lg font-semibold text-gray-900 mb-6">基本信息</h3>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="md:col-span-2">
<label class="block text-sm font-medium text-gray-700 mb-2">客户名称 <span class="text-red-500">*</span></label>
<input type="text" id="title" name="title" required class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm" placeholder="例如：华润万家超市">
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">应收金额 <span class="text-red-500">*</span></label>
<div class="relative">
<span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm">¥</span>
<input type="number" id="amount" name="amount" required step="0.01" min="0" class="w-full pl-8 pr-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm" placeholder="请输入金额">
</div>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">账期天数</label>
<input type="number" id="payment_terms" name="payment_terms" min="0" value="30" class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm" placeholder="30">
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">开票日期 <span class="text-red-500">*</span></label>
<input type="date" id="invoice_date" name="invoice_date" required class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm">
</div>
</div>
</div>

<div class="bg-gradient-to-r from-green-50 to-teal-50 rounded-2xl p-6">
<h3 class="text-lg font-semibold text-gray-900 mb-6">联系信息</h3>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">联系人</label>
<input type="text" id="contact_person" name="contact_person" class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm" placeholder="例如：李经理">
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">联系电话</label>
<input type="tel" id="contact_phone" name="contact_phone" class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm" placeholder="例如：138-0001-2345">
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-gray-700 mb-2">联系地址</label>
<input type="text" id="contact_address" name="contact_address" class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm" placeholder="例如：深圳市南山区科技园南区">
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-gray-700 mb-2">备注说明</label>
<textarea id="notes" name="notes" rows="4" class="w-full px-4 py-3 bg-white/80 border border-gray-200 rounded-button focus:outline-none focus:ring-2 focus:ring-primary/20 text-gray-900 text-sm resize-none" placeholder="请输入相关备注信息，如交易详情、用途说明等..."></textarea>
</div>
</div>
</div>

<div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
<a href="{{ url_for('receivables') }}" class="px-8 py-3 bg-gray-100 text-gray-700 rounded-button whitespace-nowrap hover:bg-gray-200 transition-colors font-medium">取消</a>
<button type="submit" class="px-8 py-3 bg-primary text-white rounded-button whitespace-nowrap hover:bg-primary/90 transition-colors font-medium flex items-center space-x-2">
<div class="w-4 h-4 flex items-center justify-center">
<i class="ri-save-line"></i>
</div>
<span>保存应收款</span>
</button>
</div>
</form>
</div>
</div>
</main>
</div>
</body>

<script>
// 表单验证
document.getElementById('receivableForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const title = formData.get('title');
    const amount = parseFloat(formData.get('amount'));
    const invoiceDate = formData.get('invoice_date');
    
    if (!title || title.trim() === '') {
        alert('请输入客户名称');
        return;
    }
    
    if (!amount || amount <= 0) {
        alert('请输入有效的应收金额');
        return;
    }
    
    if (!invoiceDate) {
        alert('请选择开票日期');
        return;
    }
    
    // 如果验证通过，提交表单
    this.submit();
});

// 页面加载时初始化
document.addEventListener('DOMContentLoaded', function() {
    // 设置默认开票日期为今天
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('invoice_date').value = today;
});
</script>
{% endblock %}